<Window x:Class="BrickRigsModManager.UpdateDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Update Available" Height="450" Width="600"
        WindowStartupLocation="CenterOwner"
        Background="{DynamicResource BackgroundBrush}"
        Foreground="{DynamicResource ForegroundBrush}"
        ResizeMode="NoResize">
    <Window.Resources>
        <!-- Modern Button Style -->
        <Style x:Key="ModernButton" TargetType="{x:Type Button}">
            <Setter Property="Background" Value="{DynamicResource BackgroundSecondaryBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource ForegroundBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Margin" Value="5,0,0,0"/>
            <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border x:Name="border" 
                                Background="{TemplateBinding Background}" 
                                BorderBrush="{TemplateBinding BorderBrush}" 
                                BorderThickness="{TemplateBinding BorderThickness}" 
                                CornerRadius="4" 
                                SnapsToDevicePixels="true">
                            <ContentPresenter x:Name="contentPresenter" 
                                             Focusable="False" 
                                             HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                             Margin="{TemplateBinding Padding}" 
                                             RecognizesAccessKey="True" 
                                             SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
                                             VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter Property="Background" TargetName="border" Value="{DynamicResource AccentBrush}"/>
                                <Setter Property="BorderBrush" TargetName="border" Value="{DynamicResource AccentBrush}"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="true">
                                <Setter Property="Background" TargetName="border" Value="{DynamicResource AccentBrush}"/>
                                <Setter Property="BorderBrush" TargetName="border" Value="{DynamicResource AccentBrush}"/>
                                <Setter Property="Opacity" TargetName="border" Value="0.8"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="false">
                                <Setter Property="Opacity" TargetName="border" Value="0.5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Primary Button Style -->
        <Style x:Key="PrimaryButton" TargetType="{x:Type Button}" BasedOn="{StaticResource ModernButton}">
            <Setter Property="Background" Value="{DynamicResource AccentBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource AccentBrush}"/>
        </Style>

        <!-- Modern ScrollViewer Style -->
        <Style x:Key="ModernScrollViewer" TargetType="{x:Type ScrollViewer}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ScrollViewer}">
                        <Grid x:Name="Grid" Background="{TemplateBinding Background}">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Rectangle x:Name="Corner" Grid.Column="1" Grid.Row="1" Fill="{DynamicResource BackgroundSecondaryBrush}"/>
                            <ScrollContentPresenter x:Name="PART_ScrollContentPresenter" 
                                                  Grid.Column="0" 
                                                  Grid.Row="0" 
                                                  CanContentScroll="{TemplateBinding CanContentScroll}" 
                                                  CanHorizontallyScroll="False" 
                                                  CanVerticallyScroll="False" 
                                                  ContentTemplate="{TemplateBinding ContentTemplate}" 
                                                  Content="{TemplateBinding Content}" 
                                                  Margin="{TemplateBinding Padding}"/>
                            <ScrollBar x:Name="PART_VerticalScrollBar" 
                                      Grid.Column="1" 
                                      Grid.Row="0" 
                                      AutomationProperties.AutomationId="VerticalScrollBar" 
                                      Cursor="Arrow" 
                                      Maximum="{TemplateBinding ScrollableHeight}" 
                                      Minimum="0" 
                                      Visibility="{TemplateBinding ComputedVerticalScrollBarVisibility}" 
                                      Value="{Binding VerticalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" 
                                      ViewportSize="{TemplateBinding ViewportHeight}" 
                                      Style="{DynamicResource ModernScrollBar}"/>
                            <ScrollBar x:Name="PART_HorizontalScrollBar" 
                                      Grid.Column="0" 
                                      Grid.Row="1" 
                                      AutomationProperties.AutomationId="HorizontalScrollBar" 
                                      Cursor="Arrow" 
                                      Maximum="{TemplateBinding ScrollableWidth}" 
                                      Minimum="0" 
                                      Orientation="Horizontal" 
                                      Visibility="{TemplateBinding ComputedHorizontalScrollBarVisibility}" 
                                      Value="{Binding HorizontalOffset, Mode=OneWay, RelativeSource={RelativeSource TemplatedParent}}" 
                                      ViewportSize="{TemplateBinding ViewportWidth}" 
                                      Style="{DynamicResource ModernScrollBar}"/>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern ScrollBar Style -->
        <Style x:Key="ModernScrollBar" TargetType="{x:Type ScrollBar}">
            <Setter Property="Stylus.IsPressAndHoldEnabled" Value="false"/>
            <Setter Property="Stylus.IsFlicksEnabled" Value="false"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderBrush" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Width" Value="8"/>
            <Setter Property="MinWidth" Value="8"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ScrollBar}">
                        <Grid x:Name="Bg" 
                              Background="Transparent" 
                              SnapsToDevicePixels="true">
                            <Track x:Name="PART_Track" 
                                   IsDirectionReversed="true" 
                                   IsEnabled="{TemplateBinding IsMouseOver}">
                                <Track.DecreaseRepeatButton>
                                    <RepeatButton Command="{x:Static ScrollBar.PageUpCommand}" Opacity="0"/>
                                </Track.DecreaseRepeatButton>
                                <Track.IncreaseRepeatButton>
                                    <RepeatButton Command="{x:Static ScrollBar.PageDownCommand}" Opacity="0"/>
                                </Track.IncreaseRepeatButton>
                                <Track.Thumb>
                                    <Thumb Style="{DynamicResource ModernScrollBarThumb}"/>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="Orientation" Value="Horizontal">
                    <Setter Property="Width" Value="Auto"/>
                    <Setter Property="MinWidth" Value="0"/>
                    <Setter Property="Height" Value="8"/>
                    <Setter Property="MinHeight" Value="8"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Modern ScrollBar Thumb Style -->
        <Style x:Key="ModernScrollBarThumb" TargetType="{x:Type Thumb}">
            <Setter Property="OverridesDefaultStyle" Value="true"/>
            <Setter Property="IsTabStop" Value="false"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Thumb}">
                        <Rectangle x:Name="rectangle" 
                                   Fill="{DynamicResource BorderBrush}" 
                                   Height="Auto" 
                                   SnapsToDevicePixels="True" 
                                   Width="4" 
                                   RadiusX="2" 
                                   RadiusY="2" 
                                   Margin="2,0"/>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter Property="Fill" TargetName="rectangle" Value="{DynamicResource AccentBrush}"/>
                            </Trigger>
                            <Trigger Property="IsDragging" Value="true">
                                <Setter Property="Fill" TargetName="rectangle" Value="{DynamicResource AccentBrush}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern ProgressBar Style -->
        <Style x:Key="ModernProgressBar" TargetType="{x:Type ProgressBar}">
            <Setter Property="Background" Value="{DynamicResource BackgroundSecondaryBrush}"/>
            <Setter Property="Foreground" Value="{DynamicResource AccentBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Height" Value="20"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ProgressBar}">
                        <Grid x:Name="TemplateRoot">
                            <Border x:Name="PART_Track" 
                                    Background="{TemplateBinding Background}" 
                                    BorderBrush="{TemplateBinding BorderBrush}" 
                                    BorderThickness="{TemplateBinding BorderThickness}" 
                                    CornerRadius="4"/>
                            <Border x:Name="PART_Indicator" 
                                    Background="{TemplateBinding Foreground}" 
                                    BorderBrush="{TemplateBinding Foreground}" 
                                    BorderThickness="0" 
                                    CornerRadius="4" 
                                    HorizontalAlignment="Left" 
                                    Margin="1">
                                <Border.Clip>
                                    <RectangleGeometry x:Name="IndicatorClip"/>
                                </Border.Clip>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsIndeterminate" Value="true">
                                <Setter Property="Visibility" TargetName="PART_Indicator" Value="Collapsed"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern Border Style -->
        <Style x:Key="ModernBorder" TargetType="{x:Type Border}">
            <Setter Property="CornerRadius" Value="6"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="Background" Value="{DynamicResource BackgroundSecondaryBrush}"/>
        </Style>

        <!-- Theme Colors -->
        <SolidColorBrush x:Key="BackgroundBrush" Color="#FF1E1E1E"/>
        <SolidColorBrush x:Key="BackgroundSecondaryBrush" Color="#FF2D2D30"/>
        <SolidColorBrush x:Key="ForegroundBrush" Color="#FFFFFFFF"/>
        <SolidColorBrush x:Key="ForegroundSecondaryBrush" Color="#FFAAAAAA"/>
        <SolidColorBrush x:Key="BorderBrush" Color="#FF3F3F46"/>
        <SolidColorBrush x:Key="AccentBrush" Color="#FF007ACC"/>
    </Window.Resources>

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0" 
                   Text="Update Available" 
                   FontSize="24" 
                   FontWeight="Bold" 
                   Margin="0,0,0,10"
                   Foreground="{DynamicResource ForegroundBrush}"/>

        <!-- Version Info -->
        <StackPanel Grid.Row="1" Margin="0,0,0,15">
            <TextBlock x:Name="VersionInfoText" 
                       Text="A new version of Brick Rigs Mod Manager is available." 
                       TextWrapping="Wrap"
                       Foreground="{DynamicResource ForegroundBrush}"
                       Margin="0,0,0,10"/>

            <TextBlock x:Name="CurrentVersionText" 
                       Text="Current Version: 1.0.18.0" 
                       Foreground="{DynamicResource ForegroundSecondaryBrush}"/>

            <TextBlock x:Name="NewVersionText" 
                       Text="New Version: 1.0.19.0" 
                       Foreground="{DynamicResource AccentBrush}"
                       FontWeight="SemiBold"/>

            <TextBlock x:Name="ReleaseDateText" 
                       Text="Released: August 5, 2025" 
                       Foreground="{DynamicResource ForegroundSecondaryBrush}"/>
        </StackPanel>

        <!-- What's New -->
        <Grid Grid.Row="2" Margin="0,0,0,15">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <TextBlock Grid.Row="0" 
                       Text="What's New:" 
                       FontWeight="SemiBold" 
                       Margin="0,0,0,5"
                       Foreground="{DynamicResource ForegroundBrush}"/>

            <Border Grid.Row="1" 
                    Style="{StaticResource ModernBorder}">
                <ScrollViewer VerticalScrollBarVisibility="Auto" 
                              Padding="10"
                              Style="{StaticResource ModernScrollViewer}">
                    <ItemsControl x:Name="WhatsNewList">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal" Margin="0,3">
                                    <TextBlock Text="" Foreground="{DynamicResource AccentBrush}" Margin="0,0,8,0"/>
                                    <TextBlock Text="{Binding}" TextWrapping="Wrap" Foreground="{DynamicResource ForegroundBrush}"/>
                                </StackPanel>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Border>
        </Grid>

        <!-- Progress -->
        <StackPanel Grid.Row="3" Margin="0,0,0,15" Visibility="Collapsed" x:Name="ProgressPanel">
            <TextBlock x:Name="ProgressText" 
                       Text="Downloading update..." 
                       Margin="0,0,0,5"
                       Foreground="{DynamicResource ForegroundBrush}"/>

            <ProgressBar x:Name="ProgressBar" 
                         Height="20" 
                         Value="0" 
                         Maximum="100"
                         Style="{StaticResource ModernProgressBar}"/>
        </StackPanel>

        <!-- Buttons -->
        <Grid Grid.Row="4">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock Grid.Column="0" 
                       x:Name="StatusText" 
                       VerticalAlignment="Center"
                       Foreground="{DynamicResource ForegroundSecondaryBrush}"/>

            <Button Grid.Column="1" 
                    x:Name="RemindLaterButton" 
                    Content="Remind Me Later" 
                    Margin="0,0,10,0"
                    Style="{StaticResource ModernButton}"
                    Click="RemindLaterButton_Click"/>

            <Button Grid.Column="2" 
                    x:Name="UpdateNowButton" 
                    Content="Update Now" 
                    Style="{StaticResource PrimaryButton}"
                    Click="UpdateNowButton_Click"/>
        </Grid>
    </Grid>
</Window>
